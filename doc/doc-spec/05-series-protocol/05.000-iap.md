# 05.000 IAP (Identity Access Protocol)

## 1. Introduction

IAP (Identity Access Protocol) is used at N1 interface between AMF and identities, which is based on SCTP connection.

## 2. IAP PDU

IAP PDU (Packet Data Unit) is used for formatting th IAP packet during transfer both request and response.

```go
type IapPdu struct {
    Present int
    Payload interface{}
}
```

| Field | Description |
| - | - |
| Present | Indicate the IAP PDU type. |
| Payload | The actual IAP data. |

## 3. IAP Prensent

```go
const (
    IAP_RESERVED_EMPTY_MSG = 0
    IAP_INITIALIZATION_REQUEST = 1
    IAP_INITIALIZATION_ACCEPT = 2
    IAP_INITIALIZATION_REJECT = 3
)
```

| Present Type | Present Value |
| - | - |
| IAP_RESERVED_EMPTY_MSG | 0 |
| IAP_INITIALIZATION_REQUEST | 1 |
| IAP_INITIALIZATION_ACCEPT | 2 |
| IAP_INITIALIZATION_REJECT | 3 |

## 4. Protocol Model

### 4.1 Identity Initialization

Request:

- [IAP_INITIALZATION_REQUEST](#51-iap_initialization_request).

Reply:

- [IAP_INITIALIZATION_ACCEPT](#52-iap_initialization_accept)
- [IAP_INITIALIZATION_REJECT](#53-iap_initialization_reject)

### 4.2 Identity Registration

### 4.3 Identity De-registration

## 5. Appendix

### 5.1 IAP_INITIALIZATION_REQUEST

```go
type InitializationRequest struct {
    Jwt string `valid:"required"`
    IdentityPublicKey string `valid:"required"`
}
```

| Field | Type | Required | Description |
| - | - | - | - |
| Jwt | string | M | The one-time initialization JWT obtained from OAM or administrator, which contains the controller's public encryption key. |
| IdentityPublicKey | string | M | The identity's public key for the controller to encrypt the IAP PDU before sending the initialization accept message. |

### 5.2 IAP_INITIALIZATION_ACCEPT

```go
type InitializationAccept struct {
    Certificate string `valid:"required"`
    AccessKey string `valid:"required"`
}
```

| Field | Type | Required | Description |
| - | - | - | - |
| Certificate | string | M | The certificate for the identity to obtain authorization in the Veil-link system. |
| AccessKey | string | M | The symmetric key used to encrypt IAP PDUs in subsequent communications. |

### 5.3 IAP_INITIALIZATION_REJECT

```go
type InitializationReject struct {
    Cause string `valid:"required"`
}
```

| Field | Type | Required | Description |
| - | - | - | - |
| Cause | string | M | The fail description. |
